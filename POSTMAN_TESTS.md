# Webshop API - Postman Tests

This collection contains comprehensive API tests for the Webshop API.

## Import Collection

1. Open Postman
2. Click **Import** (top left)
3. Select **File** and choose `webshop-api-tests.postman_collection.json`
4. The collection will be imported with all endpoints and tests

## Environment Setup

The collection uses the following variables that are automatically managed:

| Variable | Description | Default Value |
|----------|-------------|----------------|
| `base_url` | API base URL | `http://localhost:3000` |
| `auth_token` | JWT token (auto-populated after login/signup) | Empty |
| `user_id` | User ID (auto-populated after signup) | Empty |
| `product_id` | Product ID (auto-populated after product creation) | Empty |
| `order_id` | Order ID (auto-populated after order creation) | Empty |

### Change Base URL

If your API is deployed on Railway:
1. In Postman, click the **Variables** button at the top
2. Change `base_url` to your Railway deployment URL (e.g., `https://your-app.railway.app`)
3. Save

## Test Folders

### 1. Health Check
- **GET /** - Verifies the API is online

### 2. Auth
- **Signup** - Create a new user account (auto-stores token)
- **Signup - Missing Username** - Tests error handling
- **Login** - Authenticate with existing credentials
- **Login - Invalid Credentials** - Tests error handling

### 3. Products
- **Get All Products** - List all products
- **Create Product** - Add new product (requires auth)
- **Create Product - Missing Authorization** - Tests auth requirement
- **Get Product by ID** - Fetch single product details
- **Get Product by ID - Not Found** - Tests 404 error
- **Update Product** - Modify product (requires auth)
- **Update Product - Missing Authorization** - Tests auth requirement
- **Delete Product** - Remove product (requires auth)
- **Delete Product - Missing Authorization** - Tests auth requirement

### 4. Orders
- **Get All Orders** - List all orders
- **Place Order** - Create new order for a product
- **Place Order - Invalid Quantity** - Tests validation
- **Place Order - Product Not Found** - Tests error handling

## Running Tests

### Run All Tests
1. Click the collection name
2. Click **Run** button
3. Click **Run Webshop API Tests**
4. All tests will execute in sequence

### Run Specific Folder
1. Click on a folder (e.g., "Auth")
2. Click **Run**
3. Only tests in that folder will execute

### Run Individual Test
1. Click on a test endpoint
2. Click **Send**
3. View response and test results in the **Test Results** tab

## Recommended Test Order

For best results, run tests in this order:

1. **Health Check** - Verify API is running
2. **Auth > Signup** - Create test user (auto-stores token)
3. **Products > Create Product** - Create test product (uses stored token)
4. **Products > Get All Products** - Verify product creation
5. **Products > Get Product by ID** - Verify product details
6. **Products > Update Product** - Modify the test product
7. **Orders > Place Order** - Create test order
8. **Orders > Get All Orders** - Verify order creation
9. **Products > Delete Product** - Clean up test product

## Test Assertions

Each test includes checks for:
- ✅ HTTP Status codes (200, 201, 400, 401, 404, etc.)
- ✅ Response structure validation
- ✅ Required fields presence
- ✅ Data type validation
- ✅ Error message validation

## Troubleshooting

### Tests Failing?

**Database not initialized:**
- Ensure the PostgreSQL tables are created (users, products, orders)
- See main README for table creation scripts

**Token expired:**
- Run the **Auth > Signup** test again to get a fresh token
- This will update the `auth_token` variable automatically

**Product not found in orders test:**
- Run **Products > Create Product** first
- This populates the `product_id` variable

**Variable not updating:**
- Check the test script (Tests tab) to ensure it's setting the variable
- Manually update variables in the environment

## Notes

- Timestamps are used in signup usernames to avoid duplicate username errors
- Product and order IDs are automatically captured for use in subsequent requests
- All DELETE operations return 204 No Content responses
- Invalid credentials return proper 401 Unauthorized responses
- Some tests might fail for not updating the right variables
- This markdown file is generated by AI, not including the tests itself.
